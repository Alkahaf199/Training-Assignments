Name: Al kahaf Ahmad
Employee Id: TAS199

					Set 1

Basic SQL Based Questions:

Q1 Write a query to display customer’s number, first name and middle name. The customer’s who don’t have middle name, for them display the last name. Give the alias name as Cust_Name.						[4 Marks] 

SELECT CONCAT(
        fname, ' ', IFNULL(mname, ltname)
    ) as Cust_Name, mobileno
FROM customer;


Q2. Write a query to display the number of client who have asked for loans but they don’t have any account in the bank though they are registered customers. Give the count an alias name of Count.					[4 Marks] 

SELECT COUNT(DISTINCT c.custid) AS Count
FROM
    customer c
    LEFT JOIN loan l ON c.custid = l.custid
    LEFT JOIN account a ON c.custid = a.custid
WHERE
    l.custid IS NOT NULL
    AND a.custid IS NULL;


Q3. Write a query to display the customer’s firstname who have multiple accounts atleast in 2 banks.	[4 Marks] 

SELECT DISTINCT
    c.fname
FROM customer c
    JOIN account a ON c.custid = a.custid
GROUP BY
    c.custid
HAVING
    COUNT(DISTINCT a.bid) >= 2;


Q4. Write a query to display the  account number who has done the highest transaction.

For example the account A00023 has done 5 transactions i.e. suppose 3 withdrawal and 2 deposits. Whereas the account A00024 has done 3 transactions i.e. suppose 2 withdrawals and 1 deposit. So account number of A00023 should be displayed. [4 Marks] 

SELECT acnumber
FROM trandetails
GROUP BY
    acnumber
ORDER BY 1
LIMIT 1;

-------------------------------------------------------------------------

Advanced SQL Based Questions

1. Create a procedure which display all the customers full name, and city  who are into business, service or studies. [4 Marks] 

DELIMITER $$

CREATE PROCEDURE details() 
BEGIN 
	SELECT CONCAT(
	        fname, ' ', COALESCE(mname, ''), ' ', ltname
	    ) AS Full_Name, city
	FROM customer
	WHERE
	    occupation IN (
	        'Business', 'Service', 'Student'
	    );
END $$ 

DELIMITER;

CALL details ();



		
